!function(t,e){"use strict";function n(){var t=v(this.getAttribute("data-id")),i=t.backdrop;i.classList.remove("fadeout"),document.body.removeChild(i);var a=t.dialog;a.style.visibility="hidden",a.classList.remove("close"),l.splice(t.index,1),this.off(e.event.transitionEnd,n,!1)}function i(e){var n=getComputedStyle(e),i=n.width,a=n.height;i=i.slice(0,i.length-2),a=a.slice(0,a.length-2);var o=t.innerHeight/2-a/2;e.style.top=o+"px"}function a(t){if(t.style.visibility="visible",!t.classList.contains("active")){i(t),t.classList.add("active");var n=t.querySelector(".circle-progress");n&&e.preloader(n).show();var a=s(t.id);l.push({dialog:t,backdrop:a}),document.body.appendChild(a)}}function o(t){if(t.classList.contains("active")){t.classList.remove("active"),t.classList.add("close");var i=t.querySelector(".circle-progress");i&&e.preloader(i).hide();var a=v(t.id),o=a.backdrop;o.classList.add("fadeout"),o.on(e.event.transitionEnd,n,!1)}}function r(t,e,n){var i=function(){var e=t.querySelector("input"),a=void 0;e&&(a=e.value),n(a),this.off("tap",i)};if("confirm"===e)t.querySelector(".btn-confirm").on("tap",i);else{var a=t.querySelector(".btn-cancel");null!==a&&a.on("tap",i)}}var c=!1,l=[],s=function(t){var e=document.createElement("div");return e.setAttribute("data-id",t),e.classList.add("backdrop-dialog"),e},d=function(t){for(var e,n=document.querySelectorAll("[data-dialog-id], [data-dialog-close]");t&&t!==document;t=t.parentNode)for(e=n.length;e--;)if(n[e]===t)return t},u=function(t){var e=d(t.target);if(e){var n=e.getAttribute("data-dialog-id");return n?document.querySelector("#"+n):f(t.target)}},f=function(t){for(var e,n=document.querySelectorAll(".dialog");t&&t!==document;t=t.parentNode)for(e=n.length;e--;)if(n[e]===t&&t.classList.contains("active"))return t},v=function(t){for(var e=l.length-1;e>=0;e--)if(l[e].dialog.id===t){var n=l[e];return n.index=e,n}return!1},p=function(t,e,n,i){e="string"==typeof e?"<p>"+e+"</p>":"";var a=typeof n;n="string"===a?n:t,i="boolean"==typeof i?i:!0;var o=document.createElement("div");o.setAttribute("class","dialog"),o.setAttribute("data-cancelable",i),o.id="auto-gen-"+t;var r=void 0===a?"":"<h3>"+n+"</h3>",c=i?'data-dialog-close="true"':"",l='<li><a class="btn btn-flat btn-cancel" '+c+" >Cancel</a></li>",s="",d="";"alert"===t?l="":"prompt"===t?s='<input type="text" placeholder="Value">':"indicator"===t&&(e="",d='<div class="circle-progress active padded-bottom"><div class="spinner"></div></div>');var u="indicator"===t?"":'<ul class="buttons">'+l+'<li><a class="btn btn-flat primary btn-confirm" data-dialog-close="true">OK</a></li></ul>',f='<div class="content"><div class="padded-full">'+r+e+s+d+"</div></div>"+u;return o.innerHTML=f,document.body.appendChild(o),o};document.on(e.event.start,function(t){if(l.length>0){var e=l[l.length-1].dialog,n=f(t.target);if(!n&&"false"!==e.getAttribute("data-cancelable")){o(e);var t=new CustomEvent("cancel",{detail:{target:e},bubbles:!0,cancelable:!0});e.dispatchEvent(t)}n&&n!==e&&n.id!==e.id&&o(e)}}),document.on("tap",function(t){var e=d(t.target),n=null;if(e&&(n=u(t),c=e,n)){if(n.classList.contains("active")?o(n):a(n),!c.classList.contains("btn-confirm")&&!c.classList.contains("btn-cancel"))return;var i=c.classList.contains("btn-confirm")?"confirm":"cancel",r=n.querySelector("input"),l=void 0;r&&(l=r.value);var t=new CustomEvent(i,{detail:{inputValue:l,target:n},bubbles:!0,cancelable:!0});n.dispatchEvent(t)}}),e.dialog=function(t){if("undefined"==typeof t)return{closeActive:function(){var t=l.length>0?!0:!1;if(t){var e=l[l.length-1].dialog;"false"!==e.getAttribute("data-cancelable")&&o(e)}return t},alert:function(t,e,n){var i=p("alert",t,e,n);return a(i),{on:function(t,e){r(i,t,e)}}},confirm:function(t,e,n){var i=p("confirm",t,e,n);return a(i),{on:function(t,e){r(i,t,e)}}},prompt:function(t,e,n){var i=p("prompt",t,e,n);return a(i),{on:function(t,e){r(i,t,e)}}},indicator:function(t,e){var n=p("indicator","",t,e);return a(n),{on:function(t,e){return r(n,t,e,!0),this},open:function(){return a(n),this},close:function(){return o(n),this}}}};var e="string"==typeof t?document.querySelector(t):t;if(null===e)throw new Error("The following element "+t+" does not exists");return{open:function(){return a(e),this},close:function(){return o(e),this},on:function(t,n){return r(e,t,n),this},isActive:function(){return e.classList.contains("active")?!0:!1}}},t.phonon=e,"object"==typeof exports?module.exports=e.dialog:"function"==typeof define&&define.amd&&define(function(){return e.dialog})}("undefined"!=typeof window?window:this,window.phonon||{});