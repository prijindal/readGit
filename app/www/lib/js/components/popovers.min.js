!function(t,e){"use strict";function n(){var t=document.querySelector(".app-active");null!==t.querySelector("div.backdrop-popover")&&t.removeChild(s),r.style.visibility="hidden",r=null}function i(e,n){if(void 0===n&&(n="left"),a=!0,e.style.visibility="visible",e.querySelector("ul").scrollTop=0,r=e,!e.classList.contains("active")){var i=document.querySelector(".app-page.app-active"),o=i.currentStyle||t.getComputedStyle(i);if("title"===n||"title-left"===n){var l=i.querySelector(".header-bar");e.style.top=l.offsetHeight+"px",e.style.left="title"===n?l.clientWidth/2+parseInt(o.marginLeft)-e.clientWidth/2+"px":16+parseInt(o.marginLeft)+"px"}else if("left"===n||"right"===n)e.style.top="12px","left"===n?e.style.left=16+parseInt(o.marginLeft)+"px":(e.style.left="auto",e.style.right="16px");else{var c=document.querySelector('.btn-popover[data-popover-id="'+e.id+'"]'),u=c.getBoundingClientRect();e.style.width=c.clientWidth+"px",e.style.top=u.top+"px",e.style.left=u.left+"px"}e.classList.contains("active")||e.classList.add("active"),i.appendChild(s)}}function o(e){a=!1,r=e,e.classList.contains("active")&&(e.classList.toggle("active"),t.setTimeout(function(){n()},250))}var l=!1,r=null,a=!1,s=document.createElement("div");s.classList.add("backdrop-popover");var c=function(t){for(var e={target:null,id:null,direction:null};t&&t!==document;t=t.parentNode){var n=t.getAttribute("data-popover-id");if(null!==n){e.target=t,e.id=n,e.direction="left",e.direction=!t.classList.contains("title")&&t.classList.contains("pull-left")?"left":!t.classList.contains("title")&&t.parentNode.classList.contains("pull-left")?"left":t.classList.contains("title")&&t.classList.contains("pull-left")?"title-left":t.parentNode&&t.parentNode.classList.contains("pull-left")&&t.classList.contains("title")?"title-left":t.classList.contains("pull-right")?"right":t.parentNode&&t.parentNode.classList.contains("pull-right")?"right":t.classList.contains("center")?"title":t.parentNode&&t.parentNode.classList.contains("center")?"title":"button";break}}return e},u=function(t){for(var e,n=document.querySelectorAll(".popover");t&&t!==document;t=t.parentNode)for(e=n.length;e--;)if(n[e]===t&&t.classList.contains("active"))return t},d=function(t){for(;t&&t!==document;t=t.parentNode)if(t===r)return!0;return!1};document.on(e.event.start,function(t){t=t.originalEvent||t;var e=u(t.target);!e&&a&&o(r),l=!1}),document.on(e.event.move,function(t){t=t.originalEvent||t,l=!0}),document.on(e.event.end,function(t){var e=t.target,n=c(e);if(n.target){var a=document.querySelector("#"+n.id);a&&(a.classList.contains("active")&&!l?o(a):i(a,n.direction))}if(null!==e.parentNode&&d(e)&&!l){o(r),t=new CustomEvent("itemchanged",{detail:{item:e.textContent,target:t.target},bubbles:!0,cancelable:!0});for(var s=document.querySelectorAll('[data-popover-id="'+r.id+'"]'),u=s.length-1;u>=0;u--){var n=s[u];"true"===n.getAttribute("data-autobind")&&("textContent"in n?n.textContent=e.textContent:n.innerText=e.innerText)}r.dispatchEvent(t)}}),e.popover=function(t){if("undefined"==typeof t)return{closeActive:function(){var t=r?!0:!1;return t&&o(r),t}};var e="string"==typeof t?document.querySelector(t):t;if(null===e)throw new Error("The popover with ID "+t+" does not exist");return{open:function(){i(e)},close:function(){o(e)}}},t.phonon=e,"object"==typeof exports?module.exports=e.popover:"function"==typeof define&&define.amd&&define(function(){return e.popover})}("undefined"!=typeof window?window:this,window.phonon||{});